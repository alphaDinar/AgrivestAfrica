{% load static %}
{% load humanize %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@8/swiper-bundle.min.css"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="{% static 'dashboard/dashboard.css' %}">
  <link rel="stylesheet" href="{% static 'dashboard/tradeLog.css' %}">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0" />
  <title>Agrivest - Dashboard</title>
</head>
<body>
  <section class="page">
    {% include 'Dashboard/sideBar.html' %}
    <section class="main">
      <div class="main_cover"></div>
      <section class="main_top">
        <div class="mt_left">
          <div class="box" id="mt_box">
            <i class="material-symbols-outlined" style="color: salmon;">numbers</i>
            <p>Total Trades</p>
            <span>{{trades.count|intcomma}}</span>
          </div>
          <div class="box" id="mt_box">
            <i class="material-symbols-outlined" style="color: skyblue;">payments</i>
            <p>Total Bought</p>
            <span>Ghc {{trades_bought|intcomma}}</span>
          </div>
          <div class="box" id="mt_box">
            <i class="material-symbols-outlined" style="color: burlywood;">savings</i>
            <p>Total Sold</p>
            <span> Ghc {{trades_sold|intcomma}}</span>
            
            {% if trades_bal > '0' %}
            <p style="color:#7ac691;" id="trade_bal">+ {{trades_bal}}</p>
            {% else %}
            <p style="color:#ff6364;" id="trade_bal">{{trades_bal}}</p>
            {% endif %}
              

            <style>
              #trade_bal{
                letter-spacing: 1px;
                font-weight: 600;
              }
            </style>
          </div>
        </div>
        <div class="mt_right">
          <div class="box" >
            <div style="width: 100%; height: 100%;display: flex; justify-content: center; align-items: center;">
              <canvas id="myChart"></canvas>
            </div>
          </div>
        </div>
      </section>
      <section class="main_low" >
        <section class="prod_box">
          <div class="prod_box_h">
            <p>Trades</p>
            <form>
              <input type="text" placeholder="Search Here">
              <button><i class="material-symbols-outlined">search</i></button>
              <select name="" id="">
                <option selected hidden value="none">Filter</option>
                <option value="">Pending</option>
                <option value="">Active</option>
                <option value="">Completed</option>
              </select>
            </form>
            <button id="prod_box_tag"><i class="material-symbols-outlined">arrow_downward</i></button>
          </div>
          <div class="prod_box_list">
            
     
            
            {% if trades %}
              {% for trade in trades %}
              <a href="{% url 'tradeLog_info' trade.slug %}" id="prod_a">
                <div class="top">
                  <p>
                    <span id="s1">{{trade.units|intcomma}} units</span>
                    <span id="s2">{{trade.trade_name}}</span>
                  </p>
                  <div>
          
                    {% if trade.status == 'Pending' %}
                    <span id="s1" style="color: rgb(36, 194, 115);">Pay here</span>
                    <div id="stat_tag" style="background: #ff6364;"></div>
                    {% elif trade.status == 'Active' %}
                    <span id="s1" style="color: rgb(36, 194, 115);">{{trade.start_date|timesince:trade.end_date}} left</span>
                    <div id="stat_tag" style="background: #00acea;"></div>
                    {% else %}
                    <div id="stat_tag" style="background: #aeecc1;"></div>
                    {% endif %}
                      
                  </div>
                </div>
                <div class="mid">
                  <img src="{{trade.image_url}}" alt="">
                </div>
                <div class="low">
                  <p><span id="s1">Cost</span> <span id="s2">Ghc {{trade.total_cost|intcomma}}</span></p>
                  <p><span id="s1">Ros%</span> <span id="s2">{{trade.profit_range_min}} - {{trade.profit_range_max}}</span></p>
                </div>
              </a>
              {% endfor %}
            {% endif %}
            
            

        </section>
      </section>
      
    </section>
  </section>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha512-z4OUqw38qNLpn1libAN9BsoDx6nbNFio5lA6CuTp9NlK83b89hgyCVq+N5FdBJptINztxn1Z3SaKSKUS5UP60Q==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>


  <script>
    const ctx = document.getElementById('myChart');
    var penCount = parseInt('{{pend_count}}')
    var actCount = parseInt('{{act_count}}')
    var compCount = parseInt('{{comp_count}}')

    new Chart(ctx, {
      type: 'doughnut',
      data: {
        // labels: ['Red', 'Blue', 'Yellow', 'Green', 'Purple', 'Orange'],
        datasets: [{
          label: 'Order Count',
          data: [penCount, actCount, compCount],
          borderWidth: 1
        }]
      },
    });


    const prods = document.querySelectorAll('[id=prod_a]')

    for (let i = 0; i < prods.length; i++) {
      prods[i]
      console.log()
      anime({
        targets: prods[i],
        opacity : [0,1],
        translateX: [-100,0],
        duration: parseInt(200) * parseInt(i+1),
        delay: parseInt(100) * parseInt(i+1)
      });
    }
  </script>

  <script>
    const main_top = document.querySelector('.main_top')
    const main_low  = document.querySelector('.main_low')
    const prod_box_tag = document.getElementById('prod_box_tag')

    prod_box_tag.onclick =()=>{
      main_top.classList.toggle('change')
      main_low.classList.toggle('change')
      prod_box_tag.classList.toggle('change')
    }
  </script>
  <script>
    const left = document.querySelector('.left')
    const left_top = document.getElementById('left_top')
    const user_con = document.querySelector('.user_con')
    const menu_a = document.querySelectorAll('[id=menu_a]')
    const menu_ab = document.querySelectorAll('[id=menu_ab]')
    const left_tag = document.getElementById('left_tag')
    const logout = document.getElementById('logout')
    const main = document.querySelector('.main')
    const main_cover = document.querySelector('.main_cover')

    const expand = document.getElementById('expand')
    const exp_menu = document.getElementById('exp_menu')
    expand.onclick =()=>{
      exp_menu.classList.toggle('change')
    }
  
  left_tag.onclick =()=>{
    handleScreen()
  }

  window.onresize =()=>{
    left_tag.onclick =()=>{
    handleScreen()
    }
  }

  const handleScreen =()=>{   
    if(window.innerWidth > 900){   
      left_tag.classList.toggle('change')
      left.classList.toggle('change')
      left_top.classList.toggle('change')
      user_con.classList.toggle('change')
      logout.classList.toggle('change')
      main.classList.toggle('change')
      menu_a.forEach(a=>{
        a.classList.toggle('change')
      })
      menu_ab.forEach(a=>{
        a.classList.toggle('change')
      })
      exp_menu.classList.toggle('mini')
    }else{
      left.classList.toggle('mini')
      main_cover.classList.toggle('change')
    }
  }
  </script>
</body>
</html>


<!-- 
<style>
  .main_nav{
    width: 100%;
    height: 10vh;
    background: salmon;
  }
</style> -->